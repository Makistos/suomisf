{% extends "base.html" %} {% block content %}
<div class="container">
    <div class="card border-primary mb-3" style="width: 720px; margin: 1rem auto">
        <div class="card-header">
            <span class="person-list">{{ work.creator_str }}</span>
        </div>
        <div class="row justify-content-md-center no-gutters">
            <div class="col">
                <div class="card-body">
                    <h5 class="card-title">
                        {{ work.title }}
                    </h5>
                    <i>
                    {% if work.title != work.orig_title %}
                    {{ work.orig_title }}
                        {%- if work.pubyear -%}
                        , {% endif %}
                    {% endif %}
                        {%- if work.pubyear -%}
                        {{ work.pubyear }}
                        {% endif %}
                    </i>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                        <b>Tyyppi:</b>
                        {% if work.collection == true %}
                        Kokoelma
                        {% else %}
                        Romaani
                        {% endif %}
                        </li>
                    </ul>
                    <ul class="list-group list-group-flush">
                        {% if work.bookseries.name|length %}
                        <li class="list-group-item">
                            <b>Kirjasarja:</b>
                            <a href=" {{ url_for('bookseries',
                                    seriesid=work.bookseries.id) }} ">{{ work.bookseries.name }}</a>
                            {%- if work.bookseriesnum %}{% if work.bookseriesnum|length -%},
                            numero {{ work.bookseriesnum }}
			    {% if prev_book %}
			    <a href="{{url_for('work',
				     workid=prev_book.id)}}"><img
								     src="/static/icons/Arrows-Left-icon.png"
								     alt="Edellinen"></a>
			    {% endif %}
			    {% if next_book %}
			    <a href="{{url_for('work',
				     workid=next_book.id)}}"><img
				     src="/static/icons/Arrows-Right-icon.png"
				     alt="Seuraava"></a>
			    {% endif %}
                        </li>
                        {% if current_user.is_admin %}
                        <li class="list-group-item">
                            <b>Sarjan järjestysnumero:</b>
                            {{ work.bookseriesorder }}
                        </li>
                        {% endif %}
                        {% endif %} {% endif %} {%- endif %}
                        {% if work.misc %}
                        <li class="list-group-item">{{ work.misc }}</li>
                        {% endif %}
                    </ul>
                </div>
            </div>
            <div class="col container col-lg-2 justify-content-end justify-content-center align-middle">
                <ul class="list-inline" style="padding: 1rem;">
                {% for genre in work.genres %}
                {# <li class="list-inline-item" style="margin-bottom: 3px; line-heigth: 1rem; padding-bottom: 1rem; "><h1 style="font-family: 'Raleway', sans-serif;"><b>{{genre.genre_name}}</b></h1></li> #}
                <li class="list-inline-item" style="padding-bottom:
                    1rem;"><img src="/static/icons/{{genre.abbr}}_32.png"></li>
                {% endfor %}
                </ul>
            </div>
        </div>
        <div class="accordion" id="workCard">
            {% if work.collection == True %}
            <div class="card">
                <div class="card-header" id="headStories">
                    <h2 class="mb-0">
                        <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                            data-target="#stories" aria-expanded="false" aria-controls="stories">
                            Novellit
                        </button>
                    </h2>
                </div>
                <div id="stories" class="collapse" aria-labelledby="headStories" data-parent="#workCard">
                    <div class="card-body">
                        {% if stories|length %}
                        <ul class="list-group list-group-flush">
                            {% for story in stories %}
                            <li class="list-group-item">
                                {% if story.creator_str != work.creator_str %}
                                <b><span class="person-list">{{ story.creator_str }}</span></b>: {% endif %}
                                <a href=" {{ url_for('story', id=story.id) }}">{{ story.title }}</a>
                                {% if story.orig_title != story.title %}({{ story.orig_title}}
                                {%- if story.pubyear %}, {{story.pubyear}}{% endif %}) {% elif
                story.pubyear %} ({{ story.pubyear}}) {% endif %}
                            </li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
            <div class="card">
                <div class="card-header" id="headEditions">
                    <h2 class="mb-0">
                        <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                            data-target="#editions" aria-expanded="false" aria-controls="editions">
                            Painokset
                        </button>
                    </h2>
                </div>
                <div id="editions" class="collapse" aria-labelledby="headEditions" data-parent="#workCard">
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            {% for edition in work.editions %}
                            <li class="list-group-item">
                                <a
                                    href=" {{ url_for('edition', editionid=edition.id) }}">{{ edition.title }}</a>.
                                    {%- if edition.translators %} {% include "_translators.html"-%}{%- endif %} {{ edition.publisher.name }} {{ edition.pubyear}}.
                                    {% if edition.pubseries.name|length %} {{ edition.pubseries.name }}
                                    {%- if edition.pubseriesnum %} {{edition.pubseriesnum }}{% endif %}. {% endif %}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
            {% if current_user.is_admin %}
            <div class="card">
                <div class="card-header" id="headAdmin">
                    <h2 class="mb-0">
                        <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                            data-target="#admin" aria-expanded="false" aria-controls="admin">
                            Ylläpito ({{work.id}})
                        </button>
                    </h2>
                </div>
                <div id="admin" class="collapse" aria-labelledby="headAdmin" data-parent="#workCard">
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item"><b>Lähde:
                                </b>{{work.imported_string}}</li>
                            <li class="list-group-item"><a href=" {{ url_for('edit_work', workid=work.id) }}">Muokkaa</a></li>
                            <li class="list-group-item"><a href=" {{ url_for('add_edition', workid=work.id) }}">Lisää painos</a></li>
                            <li class="list-group-item"><button id="myBtn">Lisää/poista kirjailija</button></li>
                        </ul>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    {% if current_user.is_admin %}
    <!-- The Modal -->
    <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <span class="close">&times;</span>
                <h2>Muokkaa kirjailijatietoja</h2>
            </div>
            <div class="modal-body">
                {% for author in authors %} {{ author.name }}
                <a href="{{ url_for('remove_author_from_work',
					 workid=work.id, authorid=author.id)}}">Poista</a><br />
                {% endfor %}
                <form action="" method="post">
                    {{ form.hidden_tag() }} {{ form.author.label }} {{
          form.author(size=100) }} {{ form.submit }}
                </form>
            </div>
            <div class="modal-footer">
                <h3></h3>
            </div>
        </div>

        {% endif %}
    </div>
</div>j
{% block script %}
<script src="/static/js/personlink.js" type="text/javascript"></script>
<script src="/static/js/author.js">
    {% include "_searchable_lists.html" %}
</script>
{% endblock %}
{% endblock %}
