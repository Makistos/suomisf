{% extends "base.html" %}
{% block content %}
<div class="container">
<h1>{{ edition.title }}
{% if current_user.is_admin %}
    ({{ edition.id }})
{% endif %}
</h1>
        {% if edition.image_src %}
        <img style="float: left; margin: 0px 10px 0px 0px;" src="{{edition.image_src}}">
        {% endif %}
        {% if edition.title != edition.work.title %}
        <div>Alkuperäinen teos: <a href=" {{ url_for('work', workid=edition.work.id) }}">{{edition.work.title }}</a>
        {%- if edition.work.pubyear %}, {{ edition.work.pubyear }}{% endif %}
            </div>
        {% endif %}
{% if edition.work.authors|length %}
<div><h2>
    {% for author in edition.work.authors %}
    <a href=" {{ url_for('person', personid=author.id) }}">{{ author.alt_name }} </a>
    {% endfor %}
    </h2></div>
{% endif %}
{% if editors|length %}
<div>
    Toimittaja(t):
    {% if editors|length == 1 %}
        <a href=" {{ url_for('person', personid=editors[0].id) }}">{{
            editors[0].alt_name }}</a>
    {% endif %}
    {% if editors|length == 2 %}
        <a href=" {{ url_for('person', personid=editors[0].id) }}">{{
            editors[0].alt_name }}</a> ja
        <a href=" {{ url_for('person', personid=editors[1].id) }}">{{
            editors[1].alt_name }}</a>

    {% endif %}
    {% if editors|length > 2 %}
        {% for editor in editors[:-1] %}
            <a href=" {{ url_for('person', personid=editor.id) }}">{{
            editor.alt_name }}</a>,
        {% endfor %}
        <a href=" {{ url_for('person', personid=editors[-1].id) }}">{{
        editors[-1].alt_name }}</a>
    {% endif %}
</div>
{% endif %}
{% if translators|length %}
<div>
    Kääntäjä(t):
        {% if translators|length == 1 %}
            <a href=" {{ url_for('person', personid=translators[0].id) }}">{{
                translators[0].alt_name }}</a>
        {% endif %}
        {% if translators|length == 2 %}
            <a href=" {{ url_for('person', personid=translators[0].id) }}">{{
                translators[0].alt_name }}</a> ja
            <a href=" {{ url_for('person', personid=translators[1].id) }}">{{
                translators[1].alt_name }}</a>

        {% endif %}
        {% if translators|length > 2 %}
            {% for translator in translators[:-1] %}
                <a href=" {{ url_for('person', personid=translator.id) }}">{{
                translator.alt_name }}</a>,
            {% endfor %}
            <a href=" {{ url_for('person', personid=translators[-1].id) }}">{{
            translators[-1].alt_name }}</a>
        {% endif %}
</div>
{% endif %}
<div>Julkaisuvuosi: {{ edition.pubyear }}</div>
<div>Painos: {{ edition.editionnum }}.</div>
<div>Kustantaja: <a href=" {{ url_for('publisher', pubid=edition.publisher.id)
                        }}">{{ edition.publisher.name }}</a></div>
{%- if edition.pubseries.name|length -%}
<div>Julkaisijan sarja: <a href=" {{ url_for('pubseries',
                                  seriesid=edition.pubseries.id) }}">{{
                                  edition.pubseries.name -}}</a>
	{%- if edition.pubseriesnum -%}
		, numero {{ edition.pubseriesnum }}</div>
	{% endif %}
{%- endif %}
{% if edition.work.bookseries.name|length %}
<div>Kirjasarja: <a href=" {{ url_for('bookseries',
                           seriesid=edition.work.bookseries.id) }} ">{{
                           edition.work.bookseries.name }}</a>
	{% if edition.work.bookseriesnum %}
		{% if edition.work.bookseriesnum|length %}
		, numero {{ edition.work.bookseriesnum }}</div>
		{% endif %}
	{% endif %}
{%- endif %}
<div>Genre: {{ edition.work.genres|join(', ', attribute='genre_name') }}</div>
<div>Muuta: {{ edition.misc }}</div>
    {% if stories|length %}
    <div>
        <h2>Novellit</h2>
        <ul>
        {% for story in stories %}
            <li>
                {% if story.creator_str != edition.work.creator_str %}
                <b><span class="person-list">{{ story.creator_str }}</span></b>:
                {% endif %}
                <a href=" {{ url_for('story', id=story.id) }}">{{ story.title }}</a>

               {% if story.orig_title != story.title %}({{ story.orig_title}}
               {%- if story.pubyear %}, {{story.pubyear}}{% endif %})
               {% elif story.pubyear %}
               ({{ story.pubyear}})
               {% endif %}
            </li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}
{% if current_user.is_admin %}
<div>Aineiston lähde: {{ edition.fullstring }}</div>
{% endif %}
{% if current_user.is_admin %}
<div><a href=" {{ url_for('edit_edition', editionid=edition.id) }}
        ">Muokkaa</a></div>
{% endif %}
<hr width=50%>
{% if other_editions %}
    <h2>Muut painokset</h2>
    {% for language in other_editions|groupby('language') %}
        <div class="edition-list">
        {% for edition in language.list %}
            {% include "_otheredition.html" %}
        {% endfor %}
        </div>
    {% endfor %}
{% endif %}
{% block script %}
<script src="/static/js/personlink.js" type="text/javascript"></script>
{% endblock %}
</div>
{% endblock %}
