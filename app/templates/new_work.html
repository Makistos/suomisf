{% extends "base.html" %}
{% block content %}

{% from 'macros.html' import render_field %}

<div class="container mt-3">
    <form action="" method="post">
        {{ form.hidden_tag() }}
        {#
        <div class="row">
            <div class="col-md-8 mb-3">
                <select class="form-control" name="test" multiple="multiple">
                    <option value="A">A</option>
                    <option value="B">B</option>
                </select>
            </div>
        </div>
        <div class="row">
            <div class="col-md-3 mb-3">
                <b>Kirjoittajat</b>
            </div>
            <div class="col-md-8 mb-3">
                <select class="author-selector form-control" multiple="multiple" data-placeholder="Kirjoittajat"
                    data-name="authors" data-search="/select_person"></select>
            </div>
        </div>
        #}
        {{ render_field(form.title) }}
        {{ render_field(form.subtitle) }}
        {{ render_field(form.orig_title) }}
        {{ render_field(form.pubyear) }}
        {% if form.misc.errors %}
        {% for error in form.misc.errors %}<br>{{ error }}{% endfor %}
        {% endif %}
        <div class="row">
            <div class="col-md-3 mb-3">
            </div>
            <div class="col-md-8 mb-3 text-align-center">
                {{ form.submit() }}
            </div>
        </div>

    </form>
</div>
{% endblock %}

{% block script %}
<script>
    $(document).ready(function () {
        $("select").each(function () {

            $(this).select2({
                ajax: {
                    //url: $(this).data("search"),
                    url: '/select_person',
                    dataType: "json",
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term,
                        };
                    }
                },
                placeholder: $(this).data("placeholder"),
                minimumInputLength: 3,
                tokenSeparators: [",", ", "],
                width: "resolve"
            });
        });
    });
</script>
{% endblock %}